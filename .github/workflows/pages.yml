name: github pages
on:
  push:
    branches:
      - master
  workflow_dispatch:
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v3
      - name: setup node
        uses: actions/setup-node@v3
        with: 
          node-version: "16"
      - name: install deps
        run: npm install -g sass
      - name: compile scss
        run: sass docs/:docs/
      - name: upload
        uses: actions/upload-pages-artifact@v1
        with:
          path: './docs'
      - name: deploy
        uses: cloudflare/wrangler-action@2.0.0
        with:
          apiToken: ${{ secrets.CF_API_TOKEN }}
          workingDirectory: 'docs' 
          command: pages publish --project-name=${{ secrets.CF_PROJ_NAME }}
